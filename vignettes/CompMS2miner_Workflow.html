<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="WMB Edmands" />

<meta name="date" content="2017-02-23" />

<title>compMS2Miner_Workflow</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">compMS2Miner_Workflow</h1>
<h4 class="author"><em>WMB Edmands</em></h4>
<h4 class="date"><em>February 23, 2017</em></h4>



<p>Matches MS1 features to MS2 spectra (.mzXML/.mzML/.mgf) files based on a mass-to-charge and retention time tolerance. Adducts and in-source fragments identified in the MS1 data set (e.g. using the CAMERA package) can be used to guide the annotation process simply adding a 4th column containing the adducts identified. Composite spectra and other supporting data can subsequently be visualized during any stage of the compMS2Miner processing workflow. Composite spectra can be denoised, ion signals grouped and summed, substructure groups identified, common Phase II metabolites predicted, both correlation and spectral similarity networks calculated, mean maximum first network neighbour chemical similarity calculation, molecular descriptor and random forest based retention time prediction and features matched to data bases monoisotopic mass data, spectral databases in the form of a NIST .msp ASCII file (examples given) and <em>in silico</em> MS2 fragmentation data using both the latest command line versions of MetFrag and CFM.</p>
<p>compMS2Miner offers the option of an entirely autonomous first-pass annotation identification workflow using a build consensus score function which takes into account multiple lines of evidence in support of an identification and automatically identifies any annotation above a minimum mean consensus score. Additionally, the contribution of each of these consensus score to a weighted mean consensus score can be globally optimized using a differential evolution algorithm.</p>
<p>The resulting fully analysed and annotated data can then be readily curated by publishing as online shiny application on shinyapps.io, as a zip file which can be shared or by sending to a local or online couchDB database. compMS2Miner makes the establishment of a stand-alone database for any metabolomics experiment extremely straightforward.</p>
<p>At any stage during the compMS2 workflow a compMS2 class object can be visualized with a Shiny web-ready application <em>compMS2Explorer</em>. <em>Composite MS2 Explorer</em> can be thought of as a study specific database for your untargetted metabolomics analysis dataset. Full usage of the <em>compMS2Explorer</em> application functionality requires an internet connection. The end result of following the workflow within this document using the example data provided can be visualized using the function, comments made in the metID comments tab can be saved on closing the application by assigning the compMS2Explorer output to an object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(compMS2Miner)
<span class="co"># assign any metabolite identification comments to a new or the same &quot;compMS2&quot; object</span>
compMS2Example_commented &lt;-<span class="st"> </span><span class="kw">compMS2Explorer</span>(compMS2Example)</code></pre></div>
<p>The following example illustrates the compMS2Miner workflow:</p>
<div id="construct-compms2-class-object." class="section level2">
<h2>1. construct compMS2 class object.</h2>
<p>From MS2 data (in the .mzXML file format) and an MS1feature table. The compMS2 object can also be constructed in as a parallel computation in the case of large peak tables and/ or larger numbers of MS2 data files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># file path example MS1features in comma delimited csv file </span>
<span class="co"># (see ?example_mzXML_MS1features for details).</span>
MS1features_example &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;MS1features_example.csv&quot;</span>, 
                                   <span class="dt">package =</span> <span class="st">&quot;compMS2Miner&quot;</span>)
<span class="co"># mzXml file examples directory (can also be .mzML or .mgf files)</span>
mzXmlDir_example &lt;-<span class="st"> </span><span class="kw">dirname</span>(MS1features_example)
<span class="co"># observation MS1 feature table column names character vector for corrNetwork function</span>
obsNames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;ACN_80_&quot;</span>, <span class="dv">6</span>), <span class="kw">rep</span>(LETTERS[<span class="dv">1</span>:<span class="dv">3</span>], <span class="dt">each=</span><span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>)),
              <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;MeOH_80_&quot;</span>, <span class="dv">6</span>), <span class="kw">rep</span>(LETTERS[<span class="dv">1</span>:<span class="dv">3</span>], <span class="dt">each=</span><span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>)))
<span class="co"># use parallel package to detect number of cores</span>
nCores &lt;-<span class="st"> </span>parallel::<span class="kw">detectCores</span>()

<span class="co"># read in example peakTable</span>
peakTable &lt;-<span class="st"> </span><span class="kw">read.csv</span>(MS1features_example, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>) 
<span class="co"># create compMS2 object</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">compMS2Construct</span>(<span class="dt">MS1features =</span> peakTable, 
                                <span class="dt">msDataDir =</span> mzXmlDir_example, <span class="dt">nCores=</span>nCores,
                                <span class="dt">mode =</span> <span class="st">&quot;pos&quot;</span>, <span class="dt">precursorPpm =</span> <span class="dv">10</span>, <span class="dt">ret =</span> <span class="dv">20</span>,
                                <span class="dt">TICfilter =</span> <span class="dv">10000</span>)

<span class="co"># View summary of compMS2 class object at any time </span>
compMS2Demo</code></pre></div>
</div>
<div id="dynamic-noise-filtration." class="section level2">
<h2>2. Dynamic noise filtration.</h2>
<p>filter variable noise from the data using a dynamic noise filter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dynamic noise filter</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">deconvNoise</span>(compMS2Demo, <span class="st">&quot;DNF&quot;</span>)
<span class="co"># View summary of compMS2 class object at any time </span>
compMS2Demo </code></pre></div>
</div>
<div id="intra-spectrum-ion-grouping-and-inter-ms2-file-spectra-grouping-with-signal-summing." class="section level2">
<h2>3. Intra-spectrum ion grouping and inter-MS2 file spectra grouping with signal summing.</h2>
<p>group and sum ions from different scans and then combine summed ion composite spectra across multiple files. This create a single composite spectra for each MS1 EIC matched to MS2 precursor scans. Optionally, a minimimum inter-spectrum similarity filter (dot product) can be applied where only spectra with a minimum spectral similarity (see argument specSimFilter in ?combineMS2.Spectra) will be combined in the resultant composite spectrum. However, if none of the spectra of a group have any similarity to one another the spectrum with the highest mean precursor intensity will be returned.</p>
<p>Additionally potential contaminants can be detected and removed from downstream analysis. Contaminants in this context are defined as repeated sequences of isobaric precursor masses of sufficient minimum length and high spectral similarity (dot product) seperated by a maximum retention time gap. These type of background ion fragmentation events can however be avoided during data-dependent MS/MS acquisition by addition to an exclusion list or using dynamic exclusion. However without foreknowledge of these isobaric contaminants, in many cases whole metabolome identification efforts can often contain many of these unwanted spectra.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># intra-spectrum ion grouping and signal summing</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">combineMS2</span>(compMS2Demo, <span class="st">&quot;Ions&quot;</span>)
<span class="co"># View summary of compMS2 class object at any time </span>
compMS2Demo
<span class="co">#inter spectrum ion grouping and signal summing if the argument specSimFilter</span>
<span class="co"># is supplied (values 0-1) then any spectrum below this spectral similarity </span>
<span class="co"># threshold (dot product) will not be included in the composite spectrum generated.</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">combineMS2</span>(compMS2Demo, <span class="st">&quot;Spectra&quot;</span>, <span class="dt">specSimFilter=</span><span class="fl">0.8</span>) 
<span class="co"># View summary of compMS2 class object at any time </span>
compMS2Demo
<span class="co"># remove any potential contaminants based on repeated isobaric precursor masses spaced by a maximum</span>
<span class="co"># retention time gap and of high spectral similarity</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">combineMS2</span>(compMS2Demo, <span class="st">'removeContam'</span>, <span class="dt">maxRtGap=</span><span class="ot">Inf</span>, <span class="dt">nContams=</span><span class="dv">4</span>)</code></pre></div>
</div>
<div id="possible-substructure-identification." class="section level2">
<h2>4. Possible substructure identification.</h2>
<p>Characteristic neutral losses/ fragments of electrospray adducts and metabolites from literature sources (?Substructure_masses for details). In addition the substructures detected with a minimum summed relative intensity above the argument minSumRelInt (default = 70%) will be automatically added to the Comments table in the compound_class column and flagged as subStructure.prob (e.g. sulfate (subStructure.prob)). In this way the comments table can be automatically filled but can be modified if necessary.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># annotate substructures</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">subStructure</span>(compMS2Demo, <span class="st">&quot;Annotate&quot;</span>)
<span class="co"># identify most probable substructure annotation based on total relative intensity</span>
<span class="co"># explained</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">subStructure</span>(compMS2Demo, <span class="st">&quot;prob&quot;</span>)
<span class="co"># summary of most probable substructure annotation</span>
mostProbSubStr &lt;-<span class="st"> </span><span class="kw">subStructure</span>(compMS2Demo, <span class="st">&quot;probSummary&quot;</span>)</code></pre></div>
</div>
<div id="metabolite-identification-methods." class="section level2">
<h2>5. Metabolite identification methods.</h2>
<p>A variety of metabolite identification methods are implemented through the function metID (see ?metID) for further details.</p>
<div id="annotate-features-using-hmdb-default" class="section level3">
<h3>Annotate features using <a href="http://www.hmdb.ca/downloads">HMDB</a> (default)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># annotate any phase II metabolites detected</span>
subStrMassShift &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">42.010565</span>, <span class="fl">119.004101</span>, <span class="fl">176.03209</span>, <span class="fl">255.988909</span>,
                     <span class="fl">305.068159</span>, <span class="fl">57.021464</span>, <span class="fl">161.014666</span>, <span class="fl">79.956817</span>)
<span class="kw">names</span>(subStrMassShift) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;acetyl&quot;</span>, <span class="st">&quot;cysteine&quot;</span>, <span class="st">&quot;glucuronide&quot;</span>,
                            <span class="st">&quot;glucuronide sulfate&quot;</span>, <span class="st">&quot;glutathione&quot;</span>, <span class="st">&quot;glycine&quot;</span>,
                            <span class="st">&quot;mercapturate&quot;</span>, <span class="st">&quot;sulfate&quot;</span>)
subStrTypesDetected &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">names</span>(subStrMassShift), function(x){
                              <span class="kw">grepl</span>(x, <span class="kw">Comments</span>(compMS2Demo)$compound_class,
                                    <span class="dt">ignore.case=</span><span class="ot">TRUE</span>)})
subStrMassShift &lt;-<span class="st"> </span>subStrMassShift[subStrTypesDetected]
<span class="co">#  common mandatory esi adducts i.e. added to those detected in the MS1 data by CAMERA</span>
mandEsiAdducts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'[M-H2O-H]-'</span>, <span class="st">'[M+Na-2H]-'</span>, <span class="st">'[M+Cl]-'</span>, <span class="st">'[M+K-2H]-'</span>, <span class="st">'[M-H+HCOOH]-'</span>, 
                    <span class="st">&quot;[M-H+CH3COOH+Na]-&quot;</span>, <span class="st">&quot;[M-H+CH3COOH]-&quot;</span>) 
<span class="co"># what if any substructure detected?</span>
subStrMassShift &lt;-<span class="st"> </span>subStrMassShift[<span class="kw">names</span>(subStrMassShift) %in%<span class="st"> </span><span class="kw">names</span>(mostProbSubStr)]
<span class="co">#  common mandatory esi adducts i.e. added to those detected in the MS1 data by CAMERA</span>
<span class="co">#  adducts supplied as structures can be automatically interpreted with the adduct2mass function</span>
<span class="co">#  N.B. The default is to use a large number of adduct and fragments from the </span>
<span class="co">#  paper of Stanstrup et. al.. See ?metID.dbAnnotate for details</span>
mandEsiAdducts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'[M+H]+'</span>, <span class="st">'[M+NH4]+'</span>, <span class="st">'[M+Na]+'</span>,<span class="st">'[M+CH3OH+H]+'</span>, <span class="st">'[M+CH3COONa]+'</span>,
                    <span class="st">'[M+K]+'</span>)
<span class="co"># elements to consider in the database annotation. Any structure containing an </span>
<span class="co"># element symbol not in this list will be filtered out</span>
includeElements=<span class="kw">c</span>(<span class="st">'C'</span>, <span class="st">'H'</span>, <span class="st">'N'</span>, <span class="st">'O'</span>, <span class="st">'P'</span>, <span class="st">'S'</span>, <span class="st">'F'</span>, <span class="st">'Cl'</span>, <span class="st">'Br'</span>, <span class="st">'I'</span>)
<span class="co"># annotate composite MS2 matched MS1 features to metabolomic databases (default</span>
<span class="co">#is HMDB, also LMSD (lipidMaps), DrugBank, T3DB and ReSpect databases can also be queried).</span>
<span class="co">#Warning: this may take 2-3 mins as large number of query masses</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;dbAnnotate&quot;</span>, <span class="dt">esiAdduct=</span>mandEsiAdducts, 
                     <span class="dt">includeElements=</span>includeElements)</code></pre></div>
</div>
<div id="annotate-features-using-lmsd-lipidmaps-structural-database" class="section level3">
<h3>Annotate features using <a href="http://www.lipidmaps.org/resources/downloads/index.html">LMSD</a> (LipidMaps Structural Database)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;dbAnnotate&quot;</span>, <span class="dt">metDB=</span>LMSD, <span class="dt">esiAdduct=</span>mandEsiAdducts, 
                     <span class="dt">includeElements=</span>includeElements)</code></pre></div>
</div>
<div id="annotate-features-using-drugbank" class="section level3">
<h3>Annotate features using <a href="http://www.drugbank.ca/downloads">Drugbank</a></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;dbAnnotate&quot;</span>, <span class="dt">metDB=</span>drugBank, <span class="dt">esiAdduct=</span>mandEsiAdducts, 
                     <span class="dt">includeElements=</span>includeElements)</code></pre></div>
</div>
<div id="annotate-features-using-t3db" class="section level3">
<h3>Annotate features using <a href="http://www.T3DB.ca/downloads">T3DB</a></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;dbAnnotate&quot;</span>, <span class="dt">metDB=</span>T3DB, <span class="dt">esiAdduct=</span>mandEsiAdducts, 
                     <span class="dt">includeElements=</span>includeElements)</code></pre></div>
</div>
<div id="annotate-features-using-respect-database" class="section level3">
<h3>Annotate features using <a href="http://spectra.psc.riken.jp/menta.cgi/respect/download/download">ReSpect</a> database</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;dbAnnotate&quot;</span>, <span class="dt">metDB=</span>ReSpect, <span class="dt">esiAdduct=</span>mandEsiAdducts, 
                     <span class="dt">includeElements=</span>includeElements)</code></pre></div>
</div>
<div id="match-composite-spectra-to-spectral-databases-as-.msp-files" class="section level3">
<h3>match composite spectra to spectral databases as .msp files</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># match composite spectra to spectral databases as .msp files </span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">'matchSpectralDB'</span>)</code></pre></div>
</div>
<div id="match-to-lipidblast-with-smiles-added-on-github-repository" class="section level3">
<h3>match to lipidBlast with SMILES added on GitHub repository</h3>
<p>N.B. It is faster to utilize local copies of msp files rather than reading from the internet. If you are anticipating frequent access of msp files then create a local archive by downloading from MoNa or cloning the msp file repository on GitHub (with SMILES codes added by OpenBabel). <a href="https://github.com/WMBEdmands/mspFiles" class="uri">https://github.com/WMBEdmands/mspFiles</a>. In the case that smiles codes are not contained in the msp file then if a copy of the openBabel (openbabel.org) command line tool is installed in your path then the matchSpectralDB function will automatically convert InChI codes to smiles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lbMspFiles &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">'https://raw.githubusercontent.com/WMBEdmands/mspFiles/master/MoNA-export-Libraries_-_LipidBlast_SMILES_'</span>, <span class="dv">1</span>:<span class="dv">5</span>, <span class="st">'.msp'</span>)
for(i in <span class="dv">1</span>:<span class="dv">5</span>){
 compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">'matchSpectralDB'</span>, <span class="dt">mspFile=</span>lbMspFiles[i]) 
}</code></pre></div>
</div>
<div id="select-most-probable-annotations-based-on-substructures-detected" class="section level3">
<h3>select most probable annotations based on substructures detected</h3>
<p>A substructure score is calculated based on the prescence of susbstructures detected in each SMILES code. This score can be used to rank metabolites based on the substructures detected. The argument minTimesId (default=2) is set to 1 this means that a substructure type (e.g. sulfate, phosphatidylcholine) must be detected at least this many times to be considered for the similarity scoring. If a substructure has been identified once by chance then these will not be considered if this argument is set to 2. For phosphatidylcholines/sphingomyelins for instance often only 1 fragment is detected (the PC head group ~184 m/z).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select most probable annotations based on substructures detected</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;dbProb&quot;</span>, <span class="dt">minTimesId=</span><span class="dv">1</span>)</code></pre></div>
</div>
<div id="phase-ii-metabolite-prediction-from-smiles-codes" class="section level3">
<h3>Phase II metabolite prediction from SMILES codes</h3>
<p>Crude single Phase II metabolite structural prediction. If sulfate, glucuronide or glycine conjugates have been annotated then approriate functional groups are identified in each SMILES code (i.e. hydroxyl, amine and carboxylic acid groups) and then the first appropriate function group in the SMILES code is used to generate a possible Phase II metabolite structure. These structures then replace the previous SMILES code in the SMILES column. In addition the Phase II metabolite type is added to the DBid column in the Best Annotations and the substructure type in the SubStr_type column removed to indicate that this function has been run. You can then visualize the structure in compMS2Explorer by clicking and viewing using the PUG-rest service of pubMed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># predict Phase II metabolites from SMILES codes</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;predSMILES&quot;</span>)</code></pre></div>
</div>
<div id="in-silico-fragmentation-prediction-using-the-command-line-version-of-metfrag-cl-2.3" class="section level3">
<h3>In silico fragmentation prediction using the command line version of <a href="http://msbi.ipb-halle.de/MetFrag/">MetFrag CL 2.3</a></h3>
<p>The adduct types considered are customizable see the default table data(metFragAdducts). N.B. These adduct names must perfectly match the adduct names supplied to metID.dbAnnotate and the internal adduct2mass function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># metFrag in silico fragmentation.</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;metFrag&quot;</span>)</code></pre></div>
</div>
<div id="in-silico-fragmentation-prediction-using-the-command-line-version-of-cfm-fraggraph-gen" class="section level3">
<h3>In silico fragmentation prediction using the command line version of <a href="https://sourceforge.net/p/cfm-id/wiki/Home/">CFM fraggraph-gen</a></h3>
<p>This function does not use the whole functionality of CFM and merely generates all possible fragments using the fraggraph-gen tool. This only considers the (de-)protonated annotations (e.g. [M+H]+ or [M-H]-) and no other ESI adduct types. This commandline tool was determined to be significantly faster and more practical for large numbers of annotations than other CFM command line tools identified. It must be noted that improved results but with additional computational time constraints could be obtained by using other trained CFM tools or the website interface. A link is included in the compMS2Explorer app to both the MetFrag and CFM online interfaces.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># CFM in silico fragmentation.</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">&quot;CFM&quot;</span>)</code></pre></div>
</div>
<div id="spectral-similarity-network-metmsline-data-preprocessing-and-correlation" class="section level3">
<h3>spectral similarity network, MetMSLine data-preprocessing and correlation</h3>
<p>network calculation. Both a spectral similarity network and correlation network can be calculated and visualized within the compMS2Explorer interface. Spectral similarity (dot product) is calculated for both the fragment pattern and also the precursor - fragment neutral loss pattern. In this way spectra with different fragments but shared neutral loss pattern will be connected. Whether the spectra are connected by highly similar fragmentation pattern or shared neutral loss pattern is highlighted on the spectral similarity plot. In this way clusters of similar spectra can be rapidly identified originating from very similar compounds. Correlation analysis provides a means to identify shared biological origins/pathways or related metabolites in the dataset. Features without MS/MS spectra can also be included in this network. In future versions annotation of these features without MS/MS spectra will be made possible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate spectral similarity network (dot product &gt;= 0.8 default)</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">'specSimNetwork'</span>)
##############################################################
### data pre-processing MS1features with MetMSLine package ###
##############################################################

if(!<span class="kw">require</span>(MetMSLine)){
  <span class="co"># if not installed then install from github</span>
  devtools::<span class="kw">install_github</span>(<span class="st">'WMBEdmands/MetMSLine'</span>)
  <span class="kw">require</span>(MetMSLine)
}

<span class="co"># zero fill</span>
peakTable &lt;-<span class="st"> </span><span class="kw">zeroFill</span>(peakTable, obsNames)
<span class="co"># log transform</span>
peakTable &lt;-<span class="st"> </span><span class="kw">logTrans</span>(peakTable, obsNames)

########################################################
######### end MetMSLine pre-processing #################
########################################################

<span class="co"># add correlation network using pre-processed MS2 matched peak table</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="dt">method=</span><span class="st">'corrNetwork'</span>, peakTable, obsNames,
                     <span class="dt">corrMethod=</span><span class="st">'pearson'</span>, <span class="dt">corrThresh=</span><span class="fl">0.90</span>, <span class="dt">MTC=</span><span class="st">'none'</span>, <span class="dt">MS2only=</span><span class="dv">3</span>)</code></pre></div>
</div>
<div id="mean-maximum-first-correlationspectral-similarity-network-neighbour-chemical" class="section level3">
<h3>mean maximum first correlation/spectral similarity network neighbour chemical</h3>
<p>similarity scoring and optional first-pass automatic possible annotation identification. This annotation is based on a mimimum mean maximum tanimoto chemical similarity with all of its neighbours (considering both correlation and spectral similarity neighbours). That is annotations for each feature are ranked by the weighted mean of the highest chemical similarities to any of it’s connected feature. In this way clusters of highly related compounds can be automatically annotated and the names added directly to the Comments table. Any features already matched to a database that is annotated by the metID.matchSpectralDB function will not be overwritten with this function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># conduct mean maximum first network neighbour chemical similarity ranking</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">'chemSim'</span>, <span class="dt">autoPossId=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="molecular-descriptor-and-random-forest-based-retention-time-prediction-modelling." class="section level3">
<h3>Molecular descriptor and Random Forest based retention time prediction modelling.</h3>
<p>This function uses any metabolite present in either a user supplied table of standards see argument standardsTable for details or any spectra already automatically or manually annotated in the Comments table. To see the Comments table at any time used the function Comments(object). The function uses pre-calculated molecular descriptors for all internal databases to save time. The molecular descriptors were calculated using the rcdk package. Any structures without molecular descriptors will be calculated automatically (e.g. predicted Phase II metabolites or external databases not contained in the package).</p>
<p>Then molecular descriptors are filtered to remove those will high numbers of missing values, zeros, non-zero variance and high inter-correlation. Then the caret package is used to identify the optimum set of molecular descriptors by recursive feature elimination (RFE). The final model is then used to calculate the predicted retention times of all annotations for each composite spectrum/feature and the degree of deviation from the expected retention time. This can be then used to rank annotations based on expected retention time. The final model can be accessed using the function rtPred(object) and then plotted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># conduct retention prediction modelling</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">'rtPred'</span>)
<span class="kw">plot</span>(<span class="kw">rtPred</span>(compMS2Demo)$rfModel)</code></pre></div>
</div>
<div id="build-metabolite-annotation-consensus-using-up-to-8-parameters-for-identification-and-automatic-possible-identity-annotation." class="section level3">
<h3>Build metabolite annotation consensus using up to 8 parameters for identification and automatic possible identity annotation.</h3>
<p>see ?metID.buildConsensus for details of the 8 options included by default (massAccuracy, spectralDB, inSilico, substructure, rtPred, chemSim, pubMed, corrMolDesc) A simple arithmetic mean of any combination of the annotation ranking scores can be used to build a consensus rank score of annotations. The most highly ranked annotations above a minimum mean consensus score can also be automatically added to the Comments table and flagged as metID.buildConsensus in the user_comments column. The include option ‘pubMed’ will return the number of references from the pubMed database for that compound name. Common phospholipid abbreviations will be also recognized before this search. This option can only be performed during specific hours in the evenings and on weekends to prevent overload of the PubMed servers. The function will pause and wait for the correct time before commencing but it is necessarily a slow process. See metID.buildConsensus for details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># build consensus metabolite annotation see ?metID.buildConsensus for details</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">'buildConsensus'</span>, <span class="dt">autoPossId=</span><span class="ot">TRUE</span>,
                     <span class="dt">include=</span><span class="kw">c</span>(<span class="st">'massAccuracy'</span>, <span class="st">'inSilico'</span>, <span class="st">'rtPred'</span>, <span class="st">'chemSim'</span>, 
                               <span class="st">'substructure'</span>))</code></pre></div>
</div>
<div id="differential-evolution-based-global-optimization-of-weights-of-any-combination-of-8-parameters-selected-for-consensus-annotation-identification-and-automatic-possible-identity-annotation." class="section level3">
<h3>Differential Evolution based global optimization of weights of any combination of 8 parameters selected for consensus annotation identification and automatic possible identity annotation.</h3>
<p>The differential evolution search heuristic can be used to globally optimize the weight of each annotation score to a weighted mean consensus score. The strategy seeks to minimize the overall mean rank of the “correct” annotations (i.e. those in the Comments table possible_identity column) which were either automatically or manually added by the user. A plot of progress is updated in the console every 20 population members (default) and the search algorithm continues up to 100 generations (default) however convergence may occur earlier and the maximum population number can therefore be reduced.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># use a differential evolution genetic algorithm to identify the optimum weights</span>
<span class="co"># of each of the 6 buildConsensus parameters ()</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">metID</span>(compMS2Demo, <span class="st">'optimConsensus'</span>, <span class="dt">autoPossId=</span><span class="ot">TRUE</span>,
                     <span class="dt">include=</span><span class="kw">c</span>(<span class="st">'massAccuracy'</span>, <span class="st">'inSilico'</span>, <span class="st">'rtPred'</span>, <span class="st">'chemSim'</span>, 
                               <span class="st">'substructure'</span>), <span class="dt">itermax=</span><span class="dv">40</span>)</code></pre></div>
</div>
</div>
<div id="optional-curate-data-as-zip-file-in-couchdb-andor-publish-results-as-a-shiny-application." class="section level2">
<h2>6. Optional curate data as zip file, in CouchDB and/or publish results as a shiny application.</h2>
<p>CompMS2 class objects can be sent to either a local or online couchDB database. Furthermore, the results of the compMS2Miner workflow can be published on the web as a shiny application to share metabolite identification information or as a self-contained zip file using the publishApp function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># publish your app to shinyapps.io see ?publishApp for more details</span>
<span class="co"># you may need to install the rsconnect and shinyapps packages and also sign up for a shinyapps.io account if you don't have one.</span>
<span class="co"># quick guide here for setting up your account: http://shiny.rstudio.com/articles/shinyapps.html</span>
<span class="kw">publishApp</span>(compMS2Demo, <span class="dt">appName=</span><span class="st">'compMS2Demo'</span>,
           <span class="dt">addFiles=</span><span class="kw">system.file</span>(<span class="st">&quot;doc&quot;</span>, <span class="st">&quot;compMS2Miner_Workflow.pdf&quot;</span>, 
                                <span class="dt">package =</span> <span class="st">&quot;compMS2Miner&quot;</span>))</code></pre></div>
<p>Or the app can be published as a self-contained zip file (which can be uploaded to an online repository), shared with collaborators as a standalone file. All of the files necessary to run the application are contained in the zip file bundle. This means that even in the future the application will be viewable. You can add also optionally add your R markdown pdf file and other additional files to the zip file which will then be displayed in the application, this allows the code used to generate the app to be included along with the application.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">publishApp</span>(compMS2Demo, <span class="dt">appName=</span><span class="st">'compMS2Demo'</span>, 
           <span class="dt">writeDir=</span><span class="st">'C:/'</span>, 
           <span class="dt">addFiles=</span><span class="kw">system.file</span>(<span class="st">&quot;doc&quot;</span>, <span class="st">&quot;compMS2Miner_Workflow.pdf&quot;</span>, 
                                <span class="dt">package =</span> <span class="st">&quot;compMS2Miner&quot;</span>))</code></pre></div>
<p>Alternatively absolutely everything can be published together so anyone can reproduce the workflow this could include the peak-picker output table and the mzXML files also. The zip file is compressed but including the mzXML files and peak table will make the file much larger. However with this approach all of the data needed to fully reproduce the results is included in one bundle.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mzXmlFiles &lt;-<span class="st"> </span><span class="kw">list.files</span>(mzXmlDir_example, <span class="dt">full.names =</span> <span class="ot">TRUE</span>, <span class="dt">pattern=</span><span class="st">'</span><span class="ch">\\</span><span class="st">.mzXML$'</span>)
<span class="kw">publishApp</span>(compMS2Demo, <span class="dt">appName=</span><span class="st">'compMS2Demo'</span>, 
           <span class="dt">writeDir=</span><span class="st">'C:/'</span>, 
           <span class="dt">addFiles=</span><span class="kw">c</span>(<span class="kw">system.file</span>(<span class="st">&quot;doc&quot;</span>, <span class="st">&quot;compMS2Miner_Workflow.pdf&quot;</span>, 
                                  <span class="dt">package =</span> <span class="st">&quot;compMS2Miner&quot;</span>), 
                      <span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;MS1features_example.csv&quot;</span>, 
                                  <span class="dt">package =</span> <span class="st">&quot;compMS2Miner&quot;</span>), mzXmlFiles))</code></pre></div>
</div>
<div id="post-publication-the-zip-file-can-be-directly-opened-using-compms2explorer-modified-and-potentially-re-published" class="section level2">
<h2>Post “publication” the zip file can be directly opened using compMS2Explorer, modified and potentially re-published</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># full path to zip file written by publishApp function</span>
compMS2Demo &lt;-<span class="st"> </span><span class="kw">compMS2Explorer</span>(<span class="st">'C:/compMS2Demo/compMS2Demo.zip'</span>)</code></pre></div>
</div>
<div id="sessioninfo" class="section level1">
<h1>sessionInfo</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.3.2 (2016-10-31)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows &gt;= 8 x64 (build 9200)
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] parallel  tcltk     stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] DEoptim_2.2-4       caret_6.0-73        ggplot2_2.2.1      
##  [4] lattice_0.20-34     randomForest_4.6-12 rcdk_3.3.8         
##  [7] fingerprint_3.5.4   MetMSLine_1.0.2     fastcluster_1.1.22 
## [10] fpc_2.1-10          zoo_1.7-14          tcltk2_1.2-11      
## [13] igraph_1.0.1        ChemmineOB_1.12.0   ChemmineR_2.26.1   
## [16] doSNOW_1.0.14       snow_0.4-2          iterators_1.0.8    
## [19] Rcpp_0.12.9         foreach_1.4.3       compMS2Miner_2.2.3 
## [22] knitr_1.15.1       
## 
## loaded via a namespace (and not attached):
##  [1] splines_3.3.2        assertthat_0.1       stats4_3.3.2        
##  [4] yaml_2.1.14          rcdklibs_1.5.13      robustbase_0.92-7   
##  [7] backports_1.0.5      quantreg_5.29        digest_0.6.12       
## [10] minqa_1.2.4          colorspace_1.3-2     htmltools_0.3.5     
## [13] Matrix_1.2-8         plyr_1.8.4           devtools_1.12.0.9000
## [16] SparseM_1.74         zlibbioc_1.20.0      mvtnorm_1.0-5       
## [19] scales_0.4.1         itertools_0.1-3      lme4_1.1-12         
## [22] MatrixModels_0.4-1   tibble_1.2           mgcv_1.8-17         
## [25] car_2.1-4            withr_1.0.2          nnet_7.3-12         
## [28] lazyeval_0.2.0       pbkrtest_0.4-6       magrittr_1.5        
## [31] mclust_5.2.2         memoise_1.0.0        evaluate_0.10       
## [34] nlme_3.1-131         MASS_7.3-45          class_7.3-14        
## [37] rsconnect_0.7        tools_3.3.2          trimcluster_0.1-2   
## [40] stringr_1.1.0        kernlab_0.9-25       munsell_0.4.3       
## [43] cluster_2.0.5        compiler_3.3.2       grid_3.3.2          
## [46] RCurl_1.95-4.8       nloptr_1.0.4         rjson_0.2.15        
## [49] bitops_1.0-6         rmarkdown_1.3        gtable_0.2.0        
## [52] ModelMetrics_1.1.0   codetools_0.2-15     flexmix_2.3-13      
## [55] DBI_0.5-1            reshape2_1.4.2       prabclus_2.2-6      
## [58] rprojroot_1.2        modeltools_0.2-21    rJava_0.9-8         
## [61] stringi_1.1.2        png_0.1-7            DEoptimR_1.0-8      
## [64] diptest_0.75-7</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
